{"version":3,"sources":["../../../../src/server/lib/incremental-cache/file-system-cache.ts"],"names":["FileSystemCache","memoryCache","tagsManifest","constructor","ctx","fs","flushToDisk","serverDistDir","appDir","_appDir","revalidatedTags","maxMemoryCacheSize","LRUCache","max","length","value","JSON","kind","stringify","props","Error","data","body","html","pageData","tagsManifestPath","path","join","loadTagsManifest","parse","readFileSync","toString","err","version","items","setTags","key","tags","tag","keys","includes","push","mkdir","dirname","writeFile","console","warn","revalidateTag","revalidatedAt","Date","now","get","fetchCache","process","env","NEXT_RUNTIME","filePath","getFsPath","pathname","fileData","readFile","mtime","stat","meta","replace","cacheEntry","lastModified","getTime","headers","status","_","isAppPath","parsedData","set","cacheTags","tagsHeader","split","derivedTags","getDerivedTags","isStale","some","innerData","wasRevalidated","undefined","htmlPath"],"mappings":";;;;+BAuBA;;;eAAqBA;;;iEArBA;6DAEJ;uBAEc;;;;;;AAc/B,IAAIC;AACJ,IAAIC;AAEW,MAAMF;IAQnBG,YAAYC,GAA2B,CAAE;QACvC,IAAI,CAACC,EAAE,GAAGD,IAAIC,EAAE;QAChB,IAAI,CAACC,WAAW,GAAGF,IAAIE,WAAW;QAClC,IAAI,CAACC,aAAa,GAAGH,IAAIG,aAAa;QACtC,IAAI,CAACC,MAAM,GAAG,CAAC,CAACJ,IAAIK,OAAO;QAC3B,IAAI,CAACC,eAAe,GAAGN,IAAIM,eAAe;QAE1C,IAAIN,IAAIO,kBAAkB,IAAI,CAACV,aAAa;YAC1CA,cAAc,IAAIW,iBAAQ,CAAC;gBACzBC,KAAKT,IAAIO,kBAAkB;gBAC3BG,QAAO,EAAEC,MAAK,EAAE,EAAE;wBAcOC;oBAbvB,IAAI,CAACD,OAAO;wBACV,OAAO;oBACT,OAAO,IAAIA,MAAME,IAAI,KAAK,YAAY;wBACpC,OAAOD,KAAKE,SAAS,CAACH,MAAMI,KAAK,EAAEL,MAAM;oBAC3C,OAAO,IAAIC,MAAME,IAAI,KAAK,SAAS;wBACjC,MAAM,IAAIG,MAAM,mDAAkD;oBACpE,OAAO,IAAIL,MAAME,IAAI,KAAK,SAAS;wBACjC,OAAOD,KAAKE,SAAS,CAACH,MAAMM,IAAI,IAAI,IAAIP,MAAM;oBAChD,OAAO,IAAIC,MAAME,IAAI,KAAK,SAAS;wBACjC,OAAOF,MAAMO,IAAI,CAACR,MAAM;oBAC1B,CAAC;oBACD,wCAAwC;oBACxC,OACEC,MAAMQ,IAAI,CAACT,MAAM,GAAIE,CAAAA,CAAAA,CAAAA,kBAAAA,KAAKE,SAAS,CAACH,MAAMS,QAAQ,aAA7BR,KAAAA,IAAAA,gBAAgCF,MAAM,AAAD,KAAK,CAAA;gBAEnE;YACF;QACF,CAAC;QACD,IAAI,IAAI,CAACP,aAAa,IAAI,IAAI,CAACF,EAAE,EAAE;YACjC,IAAI,CAACoB,gBAAgB,GAAGC,aAAI,CAACC,IAAI,CAC/B,IAAI,CAACpB,aAAa,EAClB,MACA,SACA,eACA;YAEF,IAAI,CAACqB,gBAAgB;QACvB,CAAC;IACH;IAEQA,mBAAmB;QACzB,IAAI,CAAC,IAAI,CAACH,gBAAgB,IAAI,CAAC,IAAI,CAACpB,EAAE,EAAE;QACxC,IAAI;YACFH,eAAec,KAAKa,KAAK,CACvB,IAAI,CAACxB,EAAE,CAACyB,YAAY,CAAC,IAAI,CAACL,gBAAgB,EAAEM,QAAQ,CAAC;QAEzD,EAAE,OAAOC,KAAU;YACjB9B,eAAe;gBAAE+B,SAAS;gBAAGC,OAAO,CAAC;YAAE;QACzC;IACF;IAEA,MAAMC,QAAQC,GAAW,EAAEC,IAAc,EAAE;QACzC,IAAI,CAACT,gBAAgB;QACrB,IAAI,CAAC1B,gBAAgB,CAAC,IAAI,CAACuB,gBAAgB,EAAE;YAC3C;QACF,CAAC;QAED,KAAK,MAAMa,OAAOD,KAAM;YACtB,MAAMhB,OAAOnB,aAAagC,KAAK,CAACI,IAAI,IAAI;gBAAEC,MAAM,EAAE;YAAC;YACnD,IAAI,CAAClB,KAAKkB,IAAI,CAACC,QAAQ,CAACJ,MAAM;gBAC5Bf,KAAKkB,IAAI,CAACE,IAAI,CAACL;YACjB,CAAC;YACDlC,aAAagC,KAAK,CAACI,IAAI,GAAGjB;QAC5B;QAEA,IAAI;YACF,MAAM,IAAI,CAAChB,EAAE,CAACqC,KAAK,CAAChB,aAAI,CAACiB,OAAO,CAAC,IAAI,CAAClB,gBAAgB;YACtD,MAAM,IAAI,CAACpB,EAAE,CAACuC,SAAS,CACrB,IAAI,CAACnB,gBAAgB,EACrBT,KAAKE,SAAS,CAAChB,gBAAgB,CAAC;QAEpC,EAAE,OAAO8B,KAAU;YACjBa,QAAQC,IAAI,CAAC,mCAAmCd;QAClD;IACF;IAEA,MAAae,cAAcT,GAAW,EAAE;QACtC,kDAAkD;QAClD,wDAAwD;QACxD,2CAA2C;QAC3C,IAAI,CAACV,gBAAgB;QACrB,IAAI,CAAC1B,gBAAgB,CAAC,IAAI,CAACuB,gBAAgB,EAAE;YAC3C;QACF,CAAC;QAED,MAAMJ,OAAOnB,aAAagC,KAAK,CAACI,IAAI,IAAI;YAAEC,MAAM,EAAE;QAAC;QACnDlB,KAAK2B,aAAa,GAAGC,KAAKC,GAAG;QAC7BhD,aAAagC,KAAK,CAACI,IAAI,GAAGjB;QAE1B,IAAI;YACF,MAAM,IAAI,CAAChB,EAAE,CAACqC,KAAK,CAAChB,aAAI,CAACiB,OAAO,CAAC,IAAI,CAAClB,gBAAgB;YACtD,MAAM,IAAI,CAACpB,EAAE,CAACuC,SAAS,CACrB,IAAI,CAACnB,gBAAgB,EACrBT,KAAKE,SAAS,CAAChB,gBAAgB,CAAC;QAEpC,EAAE,OAAO8B,KAAU;YACjBa,QAAQC,IAAI,CAAC,mCAAmCd;QAClD;IACF;IAEA,MAAamB,IAAIf,GAAW,EAAEgB,UAAoB,EAAE;YA0G9C/B,aAQAA,cAgBQA;QAjIZ,IAAIA,OAAOpB,sBAAAA,KAAAA,IAAAA,YAAakD,GAAG,CAACf;QAE5B,qCAAqC;QACrC,IAAI,CAACf,QAAQgC,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;YAChD,IAAI;gBACF,MAAM,EAAEC,SAAQ,EAAE,GAAG,MAAM,IAAI,CAACC,SAAS,CAAC;oBACxCC,UAAU,CAAC,EAAEtB,IAAI,KAAK,CAAC;oBACvB5B,QAAQ,IAAI;gBACd;gBACA,MAAMmD,WAAW,MAAM,IAAI,CAACtD,EAAE,CAACuD,QAAQ,CAACJ;gBACxC,MAAM,EAAEK,MAAK,EAAE,GAAG,MAAM,IAAI,CAACxD,EAAE,CAACyD,IAAI,CAACN;gBAErC,MAAMO,OAAO/C,KAAKa,KAAK,CACrB,AACE,CAAA,MAAM,IAAI,CAACxB,EAAE,CAACuD,QAAQ,CAACJ,SAASQ,OAAO,CAAC,WAAW,SAAQ,EAC3DjC,QAAQ,CAAC;gBAGb,MAAMkC,aAAgC;oBACpCC,cAAcL,MAAMM,OAAO;oBAC3BpD,OAAO;wBACLE,MAAM;wBACNK,MAAMqC;wBACNS,SAASL,KAAKK,OAAO;wBACrBC,QAAQN,KAAKM,MAAM;oBACrB;gBACF;gBACA,OAAOJ;YACT,EAAE,OAAOK,GAAG;YACV,oCAAoC;YACtC;YAEA,IAAI;gBACF,MAAM,EAAEd,SAAQ,EAAEe,UAAS,EAAE,GAAG,MAAM,IAAI,CAACd,SAAS,CAAC;oBACnDC,UAAUN,aAAahB,MAAM,CAAC,EAAEA,IAAI,KAAK,CAAC;oBAC1CgB;gBACF;gBACA,MAAMO,WAAW,AAAC,CAAA,MAAM,IAAI,CAACtD,EAAE,CAACuD,QAAQ,CAACJ,SAAQ,EAAGzB,QAAQ,CAAC;gBAC7D,MAAM,EAAE8B,MAAK,EAAE,GAAG,MAAM,IAAI,CAACxD,EAAE,CAACyD,IAAI,CAACN;gBAErC,IAAIJ,YAAY;oBACd,MAAMc,eAAeL,MAAMM,OAAO;oBAClC,MAAMK,aAA+BxD,KAAKa,KAAK,CAAC8B;oBAChDtC,OAAO;wBACL6C;wBACAnD,OAAOyD;oBACT;gBACF,OAAO;oBACL,MAAMhD,WAAW+C,YACb,AACE,CAAA,MAAM,IAAI,CAAClE,EAAE,CAACuD,QAAQ,CACpB,AACE,CAAA,MAAM,IAAI,CAACH,SAAS,CAAC;wBACnBC,UAAU,CAAC,EAAEtB,IAAI,IAAI,CAAC;wBACtB5B,QAAQ,IAAI;oBACd,EAAC,EACDgD,QAAQ,CACZ,EACAzB,QAAQ,CAAC,UACXf,KAAKa,KAAK,CACR,AACE,CAAA,MAAM,IAAI,CAACxB,EAAE,CAACuD,QAAQ,CACpB,AACE,CAAA,MAAM,IAAI,CAACH,SAAS,CAAC;wBACnBC,UAAU,CAAC,EAAEtB,IAAI,KAAK,CAAC;wBACvB5B,QAAQ,KAAK;oBACf,EAAC,EACDgD,QAAQ,CACZ,EACAzB,QAAQ,CAAC,QACZ;oBAEL,IAAIgC,OAA2D,CAAC;oBAEhE,IAAIQ,WAAW;wBACb,IAAI;4BACFR,OAAO/C,KAAKa,KAAK,CACf,AACE,CAAA,MAAM,IAAI,CAACxB,EAAE,CAACuD,QAAQ,CAACJ,SAASQ,OAAO,CAAC,WAAW,SAAQ,EAC3DjC,QAAQ,CAAC;wBAEf,EAAE,OAAOuC,GAAG,CAAC;oBACf,CAAC;oBAEDjD,OAAO;wBACL6C,cAAcL,MAAMM,OAAO;wBAC3BpD,OAAO;4BACLE,MAAM;4BACNM,MAAMoC;4BACNnC;4BACA4C,SAASL,KAAKK,OAAO;4BACrBC,QAAQN,KAAKM,MAAM;wBACrB;oBACF;gBACF,CAAC;gBAED,IAAIhD,MAAM;oBACRpB,sBAAAA,KAAAA,IAAAA,YAAawE,GAAG,CAACrC,KAAKf;gBACxB,CAAC;YACH,EAAE,OAAOiD,GAAG;YACV,+BAA+B;YACjC;QACF,CAAC;QACD,IAAII;QAEJ,IAAIrD,CAAAA,eAAAA,KAAAA,IAAAA,CAAAA,cAAAA,KAAMN,KAAK,YAAXM,KAAAA,IAAAA,YAAaJ,IAAF,AAAD,MAAY,QAAQ;gBACbI;YAAnB,MAAMsD,aAAatD,CAAAA,sBAAAA,KAAKN,KAAK,CAACqD,OAAO,YAAlB/C,KAAAA,IAAAA,mBAAoB,CAAC,oBAAoB;YAE5D,IAAI,OAAOsD,eAAe,UAAU;gBAClCD,YAAYC,WAAWC,KAAK,CAAC;YAC/B,CAAC;QACH,CAAC;QAED,IAAIvD,CAAAA,eAAAA,KAAAA,IAAAA,CAAAA,eAAAA,KAAMN,KAAK,YAAXM,KAAAA,IAAAA,aAAaJ,IAAF,AAAD,MAAY,UAAUyD,CAAAA,oBAAAA,KAAAA,IAAAA,UAAW5D,MAAM,AAAD,GAAG;YACrD,IAAI,CAACc,gBAAgB;YACrB,MAAMiD,cAAcC,IAAAA,qBAAc,EAACJ,aAAa,EAAE;YAElD,MAAMK,UAAUF,YAAYG,IAAI,CAAC,CAAC1C,MAAQ;oBAEtCpC;gBADF,OACEA,CAAAA,CAAAA,0BAAAA,uBAAAA,KAAAA,IAAAA,aAAcgC,KAAK,CAACI,IAAI,YAAxBpC,KAAAA,IAAAA,wBAA0B8C,aAAa,AAAD,KACtC9C,CAAAA,uBAAAA,KAAAA,IAAAA,aAAcgC,KAAK,CAACI,IAAI,CAACU,aAAa,KACnC3B,CAAAA,CAAAA,eAAAA,KAAAA,IAAAA,KAAM6C,YAAY,AAAD,KAAKjB,KAAKC,GAAG,EAAC;YAEtC;YACA,IAAI6B,SAAS;gBACX1D,KAAK6C,YAAY,GAAG,CAAC;YACvB,CAAC;QACH,CAAC;QAED,IAAI7C,QAAQA,CAAAA,eAAAA,KAAAA,IAAAA,CAAAA,eAAAA,KAAMN,KAAK,YAAXM,KAAAA,IAAAA,aAAaJ,IAAF,AAAD,MAAY,SAAS;YACzC,IAAI,CAACW,gBAAgB;YACrB,MAAMqD,YAAY5D,KAAKN,KAAK,CAACM,IAAI;YACjC,MAAMwD,cAAcC,IAAAA,qBAAc,EAACG,UAAU5C,IAAI,IAAI,EAAE;YAEvD,MAAM6C,iBAAiBL,YAAYG,IAAI,CAAC,CAAC1C,MAAQ;oBAM7CpC;gBALF,IAAI,IAAI,CAACQ,eAAe,CAAC8B,QAAQ,CAACF,MAAM;oBACtC,OAAO,IAAI;gBACb,CAAC;gBAED,OACEpC,CAAAA,CAAAA,0BAAAA,uBAAAA,KAAAA,IAAAA,aAAcgC,KAAK,CAACI,IAAI,YAAxBpC,KAAAA,IAAAA,wBAA0B8C,aAAa,AAAD,KACtC9C,CAAAA,uBAAAA,KAAAA,IAAAA,aAAcgC,KAAK,CAACI,IAAI,CAACU,aAAa,KACnC3B,CAAAA,CAAAA,eAAAA,KAAAA,IAAAA,KAAM6C,YAAY,AAAD,KAAKjB,KAAKC,GAAG,EAAC;YAEtC;YACA,gDAAgD;YAChD,wCAAwC;YACxC,IAAIgC,gBAAgB;gBAClB7D,OAAO8D;YACT,CAAC;QACH,CAAC;QAED,OAAO9D,QAAQ,IAAI;IACrB;IAEA,MAAaoD,IAAIrC,GAAW,EAAEf,IAAgC,EAAE;QAC9DpB,sBAAAA,KAAAA,IAAAA,YAAawE,GAAG,CAACrC,KAAK;YACpBrB,OAAOM;YACP6C,cAAcjB,KAAKC,GAAG;QACxB;QACA,IAAI,CAAC,IAAI,CAAC5C,WAAW,EAAE;QAEvB,IAAIe,CAAAA,eAAAA,KAAAA,IAAAA,KAAMJ,IAAI,AAAD,MAAM,SAAS;YAC1B,MAAM,EAAEuC,SAAQ,EAAE,GAAG,MAAM,IAAI,CAACC,SAAS,CAAC;gBACxCC,UAAU,CAAC,EAAEtB,IAAI,KAAK,CAAC;gBACvB5B,QAAQ,IAAI;YACd;YACA,MAAM,IAAI,CAACH,EAAE,CAACqC,KAAK,CAAChB,aAAI,CAACiB,OAAO,CAACa;YACjC,MAAM,IAAI,CAACnD,EAAE,CAACuC,SAAS,CAACY,UAAUnC,KAAKC,IAAI;YAC3C,MAAM,IAAI,CAACjB,EAAE,CAACuC,SAAS,CACrBY,SAASQ,OAAO,CAAC,WAAW,UAC5BhD,KAAKE,SAAS,CAAC;gBAAEkD,SAAS/C,KAAK+C,OAAO;gBAAEC,QAAQhD,KAAKgD,MAAM;YAAC;YAE9D;QACF,CAAC;QAED,IAAIhD,CAAAA,eAAAA,KAAAA,IAAAA,KAAMJ,IAAI,AAAD,MAAM,QAAQ;YACzB,MAAMsD,YAAY,OAAOlD,KAAKG,QAAQ,KAAK;YAC3C,MAAM,EAAEgC,UAAU4B,SAAQ,EAAE,GAAG,MAAM,IAAI,CAAC3B,SAAS,CAAC;gBAClDC,UAAU,CAAC,EAAEtB,IAAI,KAAK,CAAC;gBACvB5B,QAAQ+D;YACV;YACA,MAAM,IAAI,CAAClE,EAAE,CAACqC,KAAK,CAAChB,aAAI,CAACiB,OAAO,CAACyC;YACjC,MAAM,IAAI,CAAC/E,EAAE,CAACuC,SAAS,CAACwC,UAAU/D,KAAKE,IAAI;YAE3C,MAAM,IAAI,CAAClB,EAAE,CAACuC,SAAS,CACrB,AACE,CAAA,MAAM,IAAI,CAACa,SAAS,CAAC;gBACnBC,UAAU,CAAC,EAAEtB,IAAI,CAAC,EAAEmC,YAAY,QAAQ,MAAM,CAAC,CAAC;gBAChD/D,QAAQ+D;YACV,EAAC,EACDf,QAAQ,EACVe,YAAYlD,KAAKG,QAAQ,GAAGR,KAAKE,SAAS,CAACG,KAAKG,QAAQ,CAAC;YAG3D,IAAIH,KAAK+C,OAAO,IAAI/C,KAAKgD,MAAM,EAAE;gBAC/B,MAAM,IAAI,CAAChE,EAAE,CAACuC,SAAS,CACrBwC,SAASpB,OAAO,CAAC,WAAW,UAC5BhD,KAAKE,SAAS,CAAC;oBACbkD,SAAS/C,KAAK+C,OAAO;oBACrBC,QAAQhD,KAAKgD,MAAM;gBACrB;YAEJ,CAAC;QACH,OAAO,IAAIhD,CAAAA,eAAAA,KAAAA,IAAAA,KAAMJ,IAAI,AAAD,MAAM,SAAS;YACjC,MAAM,EAAEuC,SAAQ,EAAE,GAAG,MAAM,IAAI,CAACC,SAAS,CAAC;gBACxCC,UAAUtB;gBACVgB,YAAY,IAAI;YAClB;YACA,MAAM,IAAI,CAAC/C,EAAE,CAACqC,KAAK,CAAChB,aAAI,CAACiB,OAAO,CAACa;YACjC,MAAM,IAAI,CAACnD,EAAE,CAACuC,SAAS,CAACY,UAAUxC,KAAKE,SAAS,CAACG;YACjD,MAAM,IAAI,CAACc,OAAO,CAACC,KAAKf,KAAKA,IAAI,CAACgB,IAAI,IAAI,EAAE;QAC9C,CAAC;IACH;IAEA,MAAcoB,UAAU,EACtBC,SAAQ,EACRlD,OAAM,EACN4C,WAAU,EAKX,EAGE;QACD,IAAIA,YAAY;YACd,6DAA6D;YAC7D,iBAAiB;YACjB,OAAO;gBACLI,UAAU9B,aAAI,CAACC,IAAI,CACjB,IAAI,CAACpB,aAAa,EAClB,MACA,SACA,eACAmD;gBAEFa,WAAW,KAAK;YAClB;QACF,CAAC;QACD,IAAIA,YAAY,KAAK;QACrB,IAAIf,WAAW9B,aAAI,CAACC,IAAI,CAAC,IAAI,CAACpB,aAAa,EAAE,SAASmD;QAEtD,IAAI,CAAC,IAAI,CAAClD,MAAM,IAAIA,WAAW,KAAK,EAClC,OAAO;YACLgD;YACAe;QACF;QACF,IAAI;YACF,MAAM,IAAI,CAAClE,EAAE,CAACuD,QAAQ,CAACJ;YACvB,OAAO;gBACLA;gBACAe;YACF;QACF,EAAE,OAAOvC,KAAK;YACZ,OAAO;gBACLwB,UAAU9B,aAAI,CAACC,IAAI,CAAC,IAAI,CAACpB,aAAa,EAAE,OAAOmD;gBAC/Ca,WAAW,IAAI;YACjB;QACF;IACF;AACF"}